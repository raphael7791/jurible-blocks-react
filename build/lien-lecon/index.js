(()=>{"use strict";var e,l={283:(e,l,n)=>{const s=window.wp.blocks,r=window.wp.blockEditor,o=window.wp.element,i=window.wp.components,t=window.wp.apiFetch;var a=n.n(t);const c=window.ReactJSXRuntime,u=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"jurible/lien-lecon","version":"1.0.0","title":"Lien LeÃ§on","category":"text","icon":"welcome-learn-more","description":"Affiche un lien vers une leÃ§on Fluent Community.","keywords":["lien","lecon","cours","fluent"],"attributes":{"courseId":{"type":"integer","default":0},"courseName":{"type":"string","default":""},"lessonId":{"type":"integer","default":0},"lessonTitle":{"type":"string","default":""},"lessonUrl":{"type":"string","default":""}},"supports":{"html":false},"textdomain":"jurible-blocks-react","editorScript":"file:./index.js","editorStyle":"file:./index.css","style":"file:./style-index.css"}');(0,s.registerBlockType)(u.name,{...u,edit:function({attributes:e,setAttributes:l}){const{courseId:n,courseName:s,lessonId:t,lessonTitle:u,lessonUrl:d}=e,p=(0,r.useBlockProps)({className:"jurible-lien-lecon"}),[b,h]=(0,o.useState)([]),[m,j]=(0,o.useState)([]),[f,v]=(0,o.useState)(!0),[x,g]=(0,o.useState)(!1);(0,o.useEffect)(()=>{v(!0),a()({path:"/fluent-community/v2/courses?per_page=100"}).then(e=>{e.courses&&e.courses.data&&h(e.courses.data),v(!1)}).catch(e=>{console.error("Erreur chargement cours:",e),v(!1)})},[]),(0,o.useEffect)(()=>{n>0?(g(!0),a()({path:`/fluent-community/v2/admin/courses/${n}/lessons`}).then(e=>{e.data?j(e.data):Array.isArray(e)?j(e):e.lessons&&j(e.lessons),g(!1)}).catch(e=>{console.error("Erreur chargement leÃ§ons:",e),g(!1)})):j([])},[n]);const w=[{label:"-- SÃ©lectionner un cours --",value:0},...b.map(e=>({label:e.title,value:e.id}))],y=[{label:"-- SÃ©lectionner une leÃ§on --",value:0},...m.map(e=>({label:e.title,value:e.id}))];return t?(0,c.jsx)("div",{...p,children:(0,c.jsxs)("div",{className:"jurible-lien-lecon-card",children:[(0,c.jsxs)("div",{className:"jurible-lien-lecon-header",children:[(0,c.jsx)("span",{className:"jurible-lien-lecon-icon",children:"ðŸ”—"}),(0,c.jsx)("span",{className:"jurible-lien-lecon-label",children:"EN SAVOIR PLUS"})]}),(0,c.jsxs)("p",{className:"jurible-lien-lecon-description",children:["Consultez Ã©galement : Â« ",u," Â»"]}),(0,c.jsx)("button",{className:"jurible-lien-lecon-btn",onClick:()=>l({lessonId:0,lessonTitle:"",lessonUrl:""}),children:"Changer de leÃ§on"})]})}):(0,c.jsx)("div",{...p,children:(0,c.jsx)(i.Placeholder,{icon:"welcome-learn-more",label:"Lien vers une leÃ§on",instructions:"SÃ©lectionnez un cours puis une leÃ§on.",children:f?(0,c.jsx)(i.Spinner,{}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(i.SelectControl,{label:"Cours",value:n,options:w,onChange:e=>{const n=parseInt(e),s=b.find(e=>e.id===n);l({courseId:n,courseName:s?s.title:"",lessonId:0,lessonTitle:"",lessonUrl:""})}}),n>0&&(x?(0,c.jsx)(i.Spinner,{}):(0,c.jsx)(i.SelectControl,{label:"LeÃ§on",value:t,options:y,onChange:e=>{const s=parseInt(e),r=m.find(e=>e.id===s);if(r){const e=b.find(e=>e.id===n),o=e?e.slug:"",i=r.slug||"",t=`/${window.fluentCommunityPortalSlug||"accueil"}/course/${o}/lessons/${i}/view`;l({lessonId:s,lessonTitle:r.title,lessonUrl:t})}}}))]})})})},save:function({attributes:e}){const{lessonTitle:l,lessonUrl:n}=e,s=r.useBlockProps.save({className:"jurible-lien-lecon"});return n?(0,c.jsx)("div",{...s,children:(0,c.jsxs)("div",{className:"jurible-lien-lecon-card",children:[(0,c.jsxs)("div",{className:"jurible-lien-lecon-header",children:[(0,c.jsx)("span",{className:"jurible-lien-lecon-icon",children:"ðŸ”—"}),(0,c.jsx)("span",{className:"jurible-lien-lecon-label",children:"EN SAVOIR PLUS"})]}),(0,c.jsxs)("p",{className:"jurible-lien-lecon-description",children:["Consultez Ã©galement : Â« ",l," Â»"]}),(0,c.jsx)("a",{href:n,className:"jurible-lien-lecon-btn",target:"_blank",rel:"noopener noreferrer",children:"Voir le cours â†’"})]})}):null}})}},n={};function s(e){var r=n[e];if(void 0!==r)return r.exports;var o=n[e]={exports:{}};return l[e](o,o.exports,s),o.exports}s.m=l,e=[],s.O=(l,n,r,o)=>{if(!n){var i=1/0;for(u=0;u<e.length;u++){for(var[n,r,o]=e[u],t=!0,a=0;a<n.length;a++)(!1&o||i>=o)&&Object.keys(s.O).every(e=>s.O[e](n[a]))?n.splice(a--,1):(t=!1,o<i&&(i=o));if(t){e.splice(u--,1);var c=r();void 0!==c&&(l=c)}}return l}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,r,o]},s.n=e=>{var l=e&&e.__esModule?()=>e.default:()=>e;return s.d(l,{a:l}),l},s.d=(e,l)=>{for(var n in l)s.o(l,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:l[n]})},s.o=(e,l)=>Object.prototype.hasOwnProperty.call(e,l),(()=>{var e={658:0,694:0};s.O.j=l=>0===e[l];var l=(l,n)=>{var r,o,[i,t,a]=n,c=0;if(i.some(l=>0!==e[l])){for(r in t)s.o(t,r)&&(s.m[r]=t[r]);if(a)var u=a(s)}for(l&&l(n);c<i.length;c++)o=i[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(u)},n=globalThis.webpackChunkjurible_blocks_react=globalThis.webpackChunkjurible_blocks_react||[];n.forEach(l.bind(null,0)),n.push=l.bind(null,n.push.bind(n))})();var r=s.O(void 0,[694],()=>s(283));r=s.O(r)})();