(()=>{"use strict";var e,s={149:()=>{const e=window.wp.blocks,s=window.wp.blockEditor,r=window.wp.element,t=window.ReactJSXRuntime,l=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"jurible/flashcards","version":"1.0.0","title":"Flashcards Jurible","category":"text","icon":"welcome-learn-more","description":"Affiche les flashcards d\'une leÃ§on pour rÃ©viser","example":{},"supports":{"html":false},"attributes":{"courseId":{"type":"number","default":0},"lessonId":{"type":"number","default":0},"courseTitle":{"type":"string","default":""},"lessonTitle":{"type":"string","default":""}},"textdomain":"jurible-blocks-react","editorScript":"file:./index.js","editorStyle":"file:./index.css","style":"file:./style-index.css","viewScript":"file:./view.js"}');(0,e.registerBlockType)(l.name,{...l,edit:function({attributes:e,setAttributes:l}){const{courseId:a,lessonId:i,courseTitle:n,lessonTitle:c}=e,o=(0,s.useBlockProps)(),[d,u]=(0,r.useState)([]),[h,f]=(0,r.useState)([]),[p,v]=(0,r.useState)(!0),[j,m]=(0,r.useState)(0);return(0,r.useEffect)(()=>{fetch("/wp-json/fluent-community/v2/courses").then(e=>e.json()).then(e=>{let s=[];e.courses&&e.courses.data?s=e.courses.data:e.data&&(s=e.data),u(s),v(!1)}).catch(e=>{console.error("Erreur chargement cours:",e),v(!1)})},[]),(0,r.useEffect)(()=>{a?fetch(`/wp-json/fluent-community/v2/courses/${a}`).then(e=>e.json()).then(e=>{const s=e.sections||[];let r=[];s.forEach(e=>{(e.lessons||[]).forEach(s=>{r.push({...s,sectionTitle:e.title})})}),f(r)}).catch(e=>console.error("Erreur chargement leÃ§ons:",e)):f([])},[a]),(0,r.useEffect)(()=>{i?fetch(`/wp-json/jurible/v1/flashcards?lesson_id=${i}`).then(e=>e.json()).then(e=>{m(e.total||0)}).catch(e=>console.error("Erreur chargement flashcards:",e)):m(0)},[i]),p?(0,t.jsx)("div",{...o,children:(0,t.jsx)("div",{className:"flashcards-editor-placeholder",children:"Chargement..."})}):(0,t.jsx)("div",{...o,children:(0,t.jsxs)("div",{className:"flashcards-editor",children:[(0,t.jsxs)("div",{className:"flashcards-editor-header",children:[(0,t.jsx)("span",{className:"flashcards-icon",children:"ðŸŽ´"}),(0,t.jsx)("span",{className:"flashcards-title",children:"Flashcards Jurible"})]}),(0,t.jsxs)("div",{className:"flashcards-editor-content",children:[(0,t.jsxs)("div",{className:"flashcards-field",children:[(0,t.jsx)("label",{children:"Cours"}),(0,t.jsxs)("select",{value:a||"",onChange:e=>{const s=parseInt(e.target.value)||0,r=d.find(e=>e.id===s);l({courseId:s,courseTitle:r?r.title:"",lessonId:0,lessonTitle:""})},children:[(0,t.jsx)("option",{value:"",children:"-- SÃ©lectionner un cours --"}),d.map(e=>(0,t.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),a>0&&(0,t.jsxs)("div",{className:"flashcards-field",children:[(0,t.jsx)("label",{children:"LeÃ§on"}),(0,t.jsxs)("select",{value:i||"",onChange:e=>{const s=parseInt(e.target.value)||0,r=h.find(e=>e.id===s);l({lessonId:s,lessonTitle:r?r.title:""})},children:[(0,t.jsx)("option",{value:"",children:"-- SÃ©lectionner une leÃ§on --"}),h.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.sectionTitle," â†’ ",e.title]},e.id))]})]}),i>0&&(0,t.jsxs)("div",{className:"flashcards-info",children:[(0,t.jsx)("strong",{children:j})," flashcard",j>1?"s":""," disponible",j>1?"s":""]})]})]})})},save:function({attributes:e}){const{courseId:r,lessonId:l,courseTitle:a,lessonTitle:i}=e,n=s.useBlockProps.save();return l?(0,t.jsx)("div",{...n,children:(0,t.jsx)("div",{className:"jurible-flashcards-container","data-course-id":r,"data-lesson-id":l,"data-course-title":a,"data-lesson-title":i,children:(0,t.jsx)("div",{className:"flashcards-loading",children:"Chargement des flashcards..."})})}):null}})}},r={};function t(e){var l=r[e];if(void 0!==l)return l.exports;var a=r[e]={exports:{}};return s[e](a,a.exports,t),a.exports}t.m=s,e=[],t.O=(s,r,l,a)=>{if(!r){var i=1/0;for(d=0;d<e.length;d++){for(var[r,l,a]=e[d],n=!0,c=0;c<r.length;c++)(!1&a||i>=a)&&Object.keys(t.O).every(e=>t.O[e](r[c]))?r.splice(c--,1):(n=!1,a<i&&(i=a));if(n){e.splice(d--,1);var o=l();void 0!==o&&(s=o)}}return s}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[r,l,a]},t.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),(()=>{var e={577:0,877:0};t.O.j=s=>0===e[s];var s=(s,r)=>{var l,a,[i,n,c]=r,o=0;if(i.some(s=>0!==e[s])){for(l in n)t.o(n,l)&&(t.m[l]=n[l]);if(c)var d=c(t)}for(s&&s(r);o<i.length;o++)a=i[o],t.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return t.O(d)},r=globalThis.webpackChunkjurible_blocks_react=globalThis.webpackChunkjurible_blocks_react||[];r.forEach(s.bind(null,0)),r.push=s.bind(null,r.push.bind(r))})();var l=t.O(void 0,[877],()=>t(149));l=t.O(l)})();