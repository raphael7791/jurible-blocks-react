(()=>{function n(){document.querySelectorAll(".jurible-flashcards-container").forEach(n=>{n.dataset.initialized||function(n){if("true"===n.dataset.initialized)return;n.dataset.initialized="true";const s=n.dataset.lessonId;s?(async()=>{try{const e=await fetch(`/wp-json/jurible/v1/flashcards?lesson_id=${s}`),t=await e.json();if(!t.success||!t.data||0===t.data.length)return void(n.innerHTML='<div class="fc-empty"><p>Aucune flashcard disponible pour cette leÃ§on</p></div>');const r=t.data;let i=0,d=!1,l=0,o=0,f=[];function a(){if(i>=r.length)return void function(){const s=f.filter(n=>n.correct),a=f.filter(n=>!n.correct);n.innerHTML=`\n                <div class="fc-app">\n                    <div class="fc-results">\n                        <div class="fc-results-header">\n                            <span>ðŸŽ‰ RÃ©capitulatif fin de session</span>\n                        </div>\n                        \n                        <div class="fc-results-icon">ðŸŽŠ</div>\n                        <h2 class="fc-results-title">Session terminÃ©e !</h2>\n                        <p class="fc-results-sub">Vous avez rÃ©visÃ© ${f.length} cartes</p>\n\n                        <div class="fc-results-stats">\n                            <div class="fc-stat fc-stat-green">\n                                <span class="fc-stat-icon">âœ…</span>\n                                <span class="fc-stat-num">${s.length}</span>\n                                <span class="fc-stat-label">cartes maÃ®trisÃ©es</span>\n                            </div>\n                            <div class="fc-stat fc-stat-orange">\n                                <span class="fc-stat-icon">ðŸ”„</span>\n                                <span class="fc-stat-num">${a.length}</span>\n                                <span class="fc-stat-label">cartes Ã  revoir</span>\n                            </div>\n                        </div>\n\n                        <div class="fc-results-streak">\n                            <span>ðŸ”¥</span>\n                            <span class="fc-stat-num">${o}</span>\n                            <span class="fc-stat-label">meilleure sÃ©rie</span>\n                        </div>\n\n                        <div class="fc-results-actions">\n                            <button class="fc-btn fc-btn-primary" data-action="restart">\n                                Recommencer\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            `,n.querySelector('[data-action="restart"]').addEventListener("click",()=>{location.reload()})}();const s=r[i],e=(i+1)/r.length*100;n.innerHTML=`\n                <div class="fc-app">\n                    \x3c!-- Progress Bar --\x3e\n                    <div class="fc-progress-section">\n                        <div class="fc-progress-row">\n                            <span class="fc-progress-label">Progression</span>\n                            <span class="fc-progress-count">${i+1} / ${r.length} cartes</span>\n                        </div>\n                        <div class="fc-progress-bar">\n                            <div class="fc-progress-fill" style="width: ${e}%"></div>\n                        </div>\n                    </div>\n\n                    \x3c!-- Card --\x3e\n                    ${d?function(n){return`\n                <div class="fc-card fc-card-answer">\n                    <div class="fc-card-header">\n                        <span class="fc-card-label">RÃ©ponse</span>\n                        <span class="fc-card-num">${i+1}/${r.length}</span>\n                    </div>\n                    <div class="fc-card-body">\n                        <p>${n.reponse}</p>\n                    </div>\n                </div>\n            `}(s):function(n){return`\n                <div class="fc-card fc-card-question">\n                    <div class="fc-card-header">\n                        <span class="fc-card-label">Question</span>\n                        <span class="fc-card-num">${i+1}/${r.length}</span>\n                    </div>\n                    <div class="fc-card-body">\n                        <p>${n.question}</p>\n                    </div>\n                    <div class="fc-card-hint">\n                        <span>ðŸ‘† Cliquez pour voir la rÃ©ponse</span>\n                    </div>\n                </div>\n            `}(s)}\n\n                    \x3c!-- Buttons (only when showing answer) --\x3e\n                    ${d?'\n                        <div class="fc-buttons">\n                            <button class="fc-btn fc-btn-no" data-action="wrong">Je ne savais pas</button>\n                            <button class="fc-btn fc-btn-yes" data-action="correct">Je savais</button>\n                        </div>\n                    ':""}\n                </div>\n            `,d?(n.querySelector('[data-action="wrong"]').addEventListener("click",()=>c(!1)),n.querySelector('[data-action="correct"]').addEventListener("click",()=>c(!0))):n.querySelector(".fc-card").addEventListener("click",()=>{d=!0,a()})}function c(n){f.push({card:r[i],correct:n,index:i}),n?(l++,l>o&&(o=l)):l=0,i++,d=!1,a()}a()}catch(p){console.error("Flashcards error:",p),n.innerHTML='<div class="fc-error"><p>Erreur lors du chargement des flashcards</p></div>'}})():n.innerHTML='<div class="fc-error"><p>Aucune leÃ§on sÃ©lectionnÃ©e</p></div>'}(n)})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n):n(),new MutationObserver(s=>{let a=!1;for(const n of s)if(n.addedNodes.length>0){a=!0;break}a&&n()}).observe(document.body,{childList:!0,subtree:!0})})();